# 变更日志

本项目遵循 [语义化版本控制](https://semver.org/lang/zh-CN/) 规范。

## [未发布]

### 新增功能

#### Logger 包 v0.1.0 (2025-01-13)
- ✨ **企业级日志系统** - 基于 Zap 的高性能日志包
  - 高性能结构化日志记录
  - 智能日志轮转（按大小/时间）
  - 多输出格式支持（JSON/Console）
  - 可配置的压缩和清理策略

- 🔔 **钩子告警机制** - 可扩展的告警系统
  - 邮件告警钩子（SMTP 支持）
  - Webhook 告警钩子（HTTP POST）
  - 数据库日志钩子
  - 自定义钩子接口

- 🌐 **HTTP 中间件集成** - Web 应用日志支持
  - 请求日志记录中间件
  - 错误恢复中间件
  - 上下文追踪（Trace/Request/User ID）
  - 性能监控支持

- 🎯 **上下文感知** - 智能上下文信息管理
  - 自动提取追踪信息
  - 链路追踪支持
  - 请求级别日志关联

- ⚙️ **灵活配置** - 企业级配置管理
  - 开发/生产环境预设配置
  - 可配置采样策略
  - 动态日志级别调整
  - 完整的配置验证

- 🧪 **完整测试覆盖** - 高质量代码保障
  - 单元测试覆盖率 > 95%
  - 钩子功能测试
  - 配置验证测试
  - 使用示例和基准测试

## [v0.2.0] - 2024-09-13

### 新增功能

#### Database 包 v0.2.0
- 🔒 **并发安全优化** - 解决竞态条件问题
  - 线程安全的深拷贝机制
  - 原子性统计更新
  - 优化锁策略减少争用
  - 专门的并发测试套件

### 修复

#### Database 包
- 修复 SlowQueryMonitor 的竞态条件
- 修复配置深拷贝的线程安全问题
- 优化统计信息的原子性更新

### 文档更新
- 新增 [CONCURRENT_SAFETY.md](CONCURRENT_SAFETY.md) 并发安全指南
- 更新所有包的并发安全状态说明
- 完善代码注释和使用示例

## [v0.1.0] - 2024-09-12

### 新增功能

#### Database 包 v0.1.0 - 初始发布
- 🚀 **读写分离** - 智能数据库路由
  - 主从数据库自动路由
  - 多从库负载均衡
  - 可配置权重分配
  - 故障自动切换

- 📊 **慢查询监控** - 性能监控和分析
  - 可配置慢查询阈值
  - 查询统计分析
  - 最近慢查询记录
  - 实时监控报告

- 📝 **外部日志集成** - 统一日志管理
  - Zap 日志系统集成
  - 可配置日志级别
  - 结构化日志输出
  - 查询性能日志

- 🏥 **健康监控** - 主动监控和恢复
  - 定期健康检查
  - 自动故障检测
  - 健康状态报告
  - 连接池监控

- ⚙️ **连接池管理** - 精细化资源控制
  - 最大连接数配置
  - 空闲连接管理
  - 连接生命周期控制
  - 资源使用优化

### 项目架构
- 🏗️ **Go Workspace** - 现代化项目结构
  - 多模块协同开发
  - 独立版本管理
  - 统一依赖管理
  - 模块化设计

### 测试和质量保证
- 🧪 **完整测试套件** - 高质量代码保障
  - 单元测试覆盖率 > 85%
  - 集成测试
  - 性能基准测试
  - 使用示例验证

---

## 版本说明

### 版本格式
- **主版本号**：不兼容的 API 修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 发布计划
- **每月发布** - 定期功能更新和bug修复
- **安全更新** - 紧急安全问题随时发布
- **重大更新** - 重要功能和架构变更

### 支持政策
- **最新版本** - 完整功能支持和bug修复
- **上一版本** - 重要bug修复和安全更新
- **更早版本** - 仅安全更新

---

## 贡献指南

### 提交类型
- `feat`: 新功能
- `fix`: Bug修复
- `docs`: 文档更新
- `style`: 代码格式（不影响功能）
- `refactor`: 重构代码
- `test`: 测试相关
- `chore`: 构建过程或辅助工具的变动

### 版本发布流程
1. 功能开发和测试
2. 更新 CHANGELOG.md
3. 版本标签 `git tag v0.x.x`
4. 发布说明和文档更新

感谢所有贡献者的支持！🎉